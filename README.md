# ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆRead / Writeãƒ©ã‚¤ãƒ–ãƒ©ãƒª

GASã‹ã‚‰ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®èª­ã¿æ›¸ãã‚’ORMé¢¨ã«å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™

## âœ…ç‰¹é•·

ä»»æ„ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ç¯„å›²ã‚’`Table`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ‰±ã†ã“ã¨ã§  
ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ„Ÿçš„ã«æ“ä½œå¯èƒ½ã¨ã—ã¾ã™.

> **Note**
> - Tableã®åˆæœŸåŒ–ã¯ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§OK
> - ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆçµŒç”±ã§è¡Œã†ãŸã‚,è¡Œç•ªå·ãƒ»åˆ—ç•ªå·ã®æŒ‡å®šãŒä¸è¦
> - ä¸»ã‚­ãƒ¼ã‚’æŒã¤ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢æ“ä½œã«å¯¾å¿œ

## ğŸ¥ãƒ‡ãƒ¢

https://user-images.githubusercontent.com/33917383/236586101-5f837378-581f-4e76-acc8-4b2dc8941e00.mp4


## ğŸ“„ä½¿ã„æ–¹

### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¿½åŠ æ–¹æ³•

ã‚¹ã‚¯ãƒªãƒ—ãƒˆID : `1oTkQ04P5WysPyhfrFVf2KFynF9hH696BI1pqAnbNyDyZb82KvbJNU3ER`

ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ ã™ã‚‹éš›ã«ã€ä¸Šè¨˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆIDã‚’æŒ‡å®šã—ã¦ãã ã•ã„  
`table_lib`ã¨ã„ã†åå‰ã§ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã§ã™

![screenshot-2023-05-06-192611](https://user-images.githubusercontent.com/33917383/236618671-d457a9cd-4d78-42eb-bdd2-02d0d1f6ab67.png)

### Tableã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆ

ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ã€ä¸»ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¦Tableã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆå¯èƒ½ã§ã™
- ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›² : 1è¡Œç›®ã«ã‚«ãƒ©ãƒ åã€2è¡Œç›®ä»¥é™ã«ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚·ãƒ¼ãƒˆã®ç¯„å›²

```javascript
// ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ãƒ»ä¸»ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¦Tableã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ
const tbl = table_lib.buildTable('main!A1:ZZ', 'ID');
```

### ã‚·ãƒ¼ãƒˆã®åˆæœŸåŒ–

å¿…è¦ã§ã‚ã‚Œã°, `resetTable`ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–ã—ã¦ãã ã•ã„  
ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ã‚’å…¨ã¦ã‚¯ãƒªã‚¢ã—ã¦ã€å€¤ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚»ãƒƒãƒˆã—ã¾ã™

```javascript
// ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…¨ã¦ã‚¯ãƒªã‚¢ã—ã¦ã€æ–°è¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚»ãƒƒãƒˆ
// - æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ãªã‚‰ã‚»ãƒƒãƒˆä¸è¦
tbl.resetTable([{ ID: '101', foo: 'test' }, { ID: '102', foo: 'test2' }])
```

### ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åã€å„ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦æä¾›ã—ã¾ã™

- `Table.sheet` : ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ã®å±ã™ã‚‹ã‚·ãƒ¼ãƒˆå
- `Table.head_row` : ã‚«ãƒ©ãƒ è¡Œç•ªå·
- `Table.head_col` : å…ˆé ­åˆ—å(ex. A,B,C...)
- `Table.head` : ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ã®1è¡Œç›®ã‚’ã‚«ãƒ©ãƒ åã®é…åˆ—ã¨ã—ã¦ä¿æŒ
- `Table.hashes` : ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ã®2è¡Œç›®ä»¥é™ã‚’ã‚«ãƒ©ãƒ åã‚’ã‚­ãƒ¼ã¨ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé…åˆ—ã¨ã—ã¦ä¿æŒ
- `Table.records` : ãƒ†ãƒ¼ãƒ–ãƒ«ç¯„å›²ã®2è¡Œç›®ä»¥é™ã‚’`TRow`ã®é…åˆ—ã¨ã—ã¦ä¿æŒ
    - `TRow` : è¡Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ.è¡Œç•ªå·ã®å–å¾—ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é…åˆ—åŒ–ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‚™ãˆã‚‹.ãƒ¡ã‚½ãƒƒãƒ‰ã®æŒ¯ã‚‹èˆã„ã¯`Table`ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ä¸Šæ›¸ãå¯èƒ½

```javascript
console.log(tbl.head); // -> [ 'ID', 'foo' ]
console.log(tbl.hashes);// -> [ { ID: '101', foo: 'test' }, { ID: '102', foo: 'test2' } ]
var record = tbl.findRecord({ ID: '101' });
console.log(record.row); // -> 2
console.log(record.head); // -> [ 'ID', 'foo' ]
console.log(record.hash); // -> { ID: '101', foo: 'test' }
console.log(record.toValues()); // -> [ '101', 'test' ]
```

### ãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢

`Table.findRecord`ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€ãƒãƒƒã‚·ãƒ¥ã‚„è¡Œç•ªå·ã‚’æŒ‡å®šã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢å¯èƒ½ã§ã™

```javascript
// IDã‚’æŒ‡å®šã—ã¦æ¤œç´¢
console.log(tbl.findRecord({ ID: '101' }));
// è¡Œç•ªå·ã‚’æŒ‡å®šã—ã¦æ¤œç´¢
console.log(tbl.findRecord(10));
```

### ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°

`Table.updateRecords`ã§ä¸Šæ›¸ãã€`Table.appendRecords`ã§æœ«å°¾ã¸ã®è¿½è¨˜ãŒå¯èƒ½ã§ã™

```javascript
// ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¦æ›´æ–°
const record = tbl.findRecord({ ID: '102' });
if (record) {
  record.hash.foo = 'updated'
  tbl.updateRecords([record]);
}

// æœ«å°¾ã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½è¨˜
tbl.appendRecords([{ ID: '1004', foo: 'appended' }]);
```

## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

[src/sample.ts](https://github.com/soyalumno/table_lib/blob/main/src/sample.ts)
